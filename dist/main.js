/*! For license information please see main.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["storm-react-diagrams"]=e():t["storm-react-diagrams"]=e()}(self,(function(){return(()=>{"use strict";var t={264:function(t,e,o){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseEntity=void 0;var i=o(703),r=o(804),s=function(){function t(t){this.listeners={},this.id=t||i.Toolkit.UID(),this.locked=!1}return t.prototype.getID=function(){return this.id},t.prototype.doClone=function(t,e){void 0===t&&(t={})},t.prototype.clone=function(t){if(void 0===t&&(t={}),t[this.id])return t[this.id];var e=r.clone(this);return e.id=i.Toolkit.UID(),e.clearListeners(),t[this.id]=e,this.doClone(t,e),e},t.prototype.clearListeners=function(){this.listeners={}},t.prototype.deSerialize=function(t,e){this.id=t.id},t.prototype.serialize=function(){return{id:this.id}},t.prototype.iterateListeners=function(t){var e={id:i.Toolkit.UID(),firing:!0,entity:this,stopPropagation:function(){e.firing=!1}};for(var o in this.listeners)if(this.listeners.hasOwnProperty(o)){if(!e.firing)return;t(this.listeners[o],e)}},t.prototype.removeListener=function(t){return!!this.listeners[t]&&(delete this.listeners[t],!0)},t.prototype.addListener=function(t){var e=i.Toolkit.UID();return this.listeners[e]=t,e},t.prototype.isLocked=function(){return this.locked},t.prototype.setLocked=function(t){void 0===t&&(t=!0),this.locked=t,this.iterateListeners((function(e,o){e.lockChanged&&e.lockChanged(n(n({},o),{locked:t}))}))},t}();e.BaseEntity=s},5:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramEngine=void 0;var r=o(264),s=o(946),a=o(804),c=o(941),p=o(556),l=o(519),u=o(443),d=o(165),f=o(294),h=o(703),g=function(t){function e(){var e=t.call(this)||this;return e.canvasMatrix=[],e.routingMatrix=[],e.hAdjustmentFactor=0,e.vAdjustmentFactor=0,e.calculateMatrixDimensions=function(){var t=a.values(e.diagramModel.nodes).map((function(t){return{x:t.x,width:t.width,y:t.y,height:t.height}})),o=a.values(e.diagramModel.links),n=a.flatMap(o.map((function(t){return[t.sourcePort,t.targetPort]}))).filter((function(t){return null!==t})).map((function(t){return{x:t.x,width:t.width,y:t.y,height:t.height}})),i=a.flatMap(o.map((function(t){return t.points}))).map((function(t){return{x:t.x,width:0,y:t.y,height:0}})),r=e.canvas,s=Math.floor(Math.min(a.minBy(a.concat(t,n,i),(function(t){return t.x})).x,0)/u.ROUTING_SCALING_FACTOR)*u.ROUTING_SCALING_FACTOR,c=a.maxBy(a.concat(t,n,i),(function(t){return t.x+t.width})),p=Math.max(c.x+c.width,r.offsetWidth),l=Math.floor(Math.min(a.minBy(a.concat(t,n,i),(function(t){return t.y})).y,0)/u.ROUTING_SCALING_FACTOR)*u.ROUTING_SCALING_FACTOR,d=a.maxBy(a.concat(t,n,i),(function(t){return t.y+t.height})),f=Math.max(d.y+d.height,r.offsetHeight);return{width:Math.ceil(Math.abs(s)+p),hAdjustmentFactor:Math.abs(s)/u.ROUTING_SCALING_FACTOR+1,height:Math.ceil(Math.abs(l)+f),vAdjustmentFactor:Math.abs(l)/u.ROUTING_SCALING_FACTOR+1}},e.markNodes=function(t){a.values(e.diagramModel.nodes).forEach((function(o){for(var n=Math.floor(o.x/u.ROUTING_SCALING_FACTOR),i=Math.ceil((o.x+o.width)/u.ROUTING_SCALING_FACTOR),r=Math.floor(o.y/u.ROUTING_SCALING_FACTOR),s=Math.ceil((o.y+o.height)/u.ROUTING_SCALING_FACTOR),a=n-1;a<=i+1;a++)for(var c=r-1;c<s+1;c++)e.markMatrixPoint(t,e.translateRoutingX(a),e.translateRoutingY(c))}))},e.markPorts=function(t){a.flatMap(a.values(e.diagramModel.links).map((function(t){return[].concat(t.sourcePort,t.targetPort)}))).filter((function(t){return null!==t})).forEach((function(o){for(var n=Math.floor(o.x/u.ROUTING_SCALING_FACTOR),i=Math.ceil((o.x+o.width)/u.ROUTING_SCALING_FACTOR),r=Math.floor(o.y/u.ROUTING_SCALING_FACTOR),s=Math.ceil((o.y+o.height)/u.ROUTING_SCALING_FACTOR),a=n-1;a<=i+1;a++)for(var c=r-1;c<s+1;c++)e.markMatrixPoint(t,e.translateRoutingX(a),e.translateRoutingY(c))}))},e.markMatrixPoint=function(t,e,o){void 0!==t[o]&&void 0!==t[o][e]&&(t[o][e]=1)},e.diagramModel=new s.DiagramModel,e.nodeFactories={},e.linkFactories={},e.portFactories={},e.labelFactories={},e.canvas=null,e.paintableWidgets=null,e.linksThatHaveInitiallyRendered={},h.Toolkit.TESTING&&(h.Toolkit.TESTING_UID=0,window&&(window.diagram_instance=e)),e}return i(e,t),e.prototype.installDefaultFactories=function(){this.registerNodeFactory(new l.DefaultNodeFactory),this.registerLinkFactory(new l.DefaultLinkFactory),this.registerPortFactory(new d.DefaultPortFactory),this.registerLabelFactory(new f.DefaultLabelFactory)},e.prototype.repaintCanvas=function(){this.iterateListeners((function(t){t.repaintCanvas&&t.repaintCanvas()}))},e.prototype.clearRepaintEntities=function(){this.paintableWidgets=null},e.prototype.enableRepaintEntities=function(t){var e=this;this.paintableWidgets={},t.forEach((function(t){t instanceof c.NodeModel&&a.forEach(t.getPorts(),(function(t){a.forEach(t.getLinks(),(function(t){e.paintableWidgets[t.getID()]=!0}))})),t instanceof p.PointModel&&(e.paintableWidgets[t.getLink().getID()]=!0),e.paintableWidgets[t.getID()]=!0}))},e.prototype.isModelLocked=function(t){return!!this.diagramModel.isLocked()||t.isLocked()},e.prototype.recalculatePortsVisually=function(){this.nodesRendered=!1,this.linksThatHaveInitiallyRendered={}},e.prototype.canEntityRepaint=function(t){return null===this.paintableWidgets||void 0!==this.paintableWidgets[t.getID()]},e.prototype.setCanvas=function(t){this.canvas=t},e.prototype.setDiagramModel=function(t){this.diagramModel=t,this.recalculatePortsVisually()},e.prototype.getDiagramModel=function(){return this.diagramModel},e.prototype.getNodeFactories=function(){return this.nodeFactories},e.prototype.getLinkFactories=function(){return this.linkFactories},e.prototype.getLabelFactories=function(){return this.labelFactories},e.prototype.registerLabelFactory=function(t){this.labelFactories[t.getType()]=t,this.iterateListeners((function(t){t.labelFactoriesUpdated&&t.labelFactoriesUpdated()}))},e.prototype.registerPortFactory=function(t){this.portFactories[t.getType()]=t,this.iterateListeners((function(t){t.portFactoriesUpdated&&t.portFactoriesUpdated()}))},e.prototype.registerNodeFactory=function(t){this.nodeFactories[t.getType()]=t,this.iterateListeners((function(t){t.nodeFactoriesUpdated&&t.nodeFactoriesUpdated()}))},e.prototype.registerLinkFactory=function(t){this.linkFactories[t.getType()]=t,this.iterateListeners((function(t){t.linkFactoriesUpdated&&t.linkFactoriesUpdated()}))},e.prototype.getPortFactory=function(t){if(this.portFactories[t])return this.portFactories[t];throw new Error("cannot find factory for port of type: ["+t+"]")},e.prototype.getNodeFactory=function(t){if(this.nodeFactories[t])return this.nodeFactories[t];throw new Error("cannot find factory for node of type: ["+t+"]")},e.prototype.getLinkFactory=function(t){if(this.linkFactories[t])return this.linkFactories[t];throw new Error("cannot find factory for link of type: ["+t+"]")},e.prototype.getLabelFactory=function(t){if(this.labelFactories[t])return this.labelFactories[t];throw new Error("cannot find factory for label of type: ["+t+"]")},e.prototype.getFactoryForNode=function(t){return this.getNodeFactory(t.getType())},e.prototype.getFactoryForLink=function(t){return this.getLinkFactory(t.getType())},e.prototype.getFactoryForLabel=function(t){return this.getLabelFactory(t.getType())},e.prototype.generateWidgetForLink=function(t){var e=this.getFactoryForLink(t);if(!e)throw new Error("Cannot find link factory for link: "+t.getType());return e.generateReactWidget(this,t)},e.prototype.generateWidgetForNode=function(t){var e=this.getFactoryForNode(t);if(!e)throw new Error("Cannot find widget factory for node: "+t.getType());return e.generateReactWidget(this,t)},e.prototype.getRelativeMousePoint=function(t){var e=this.getRelativePoint(t.clientX,t.clientY);return{x:(e.x-this.diagramModel.getOffsetX())/(this.diagramModel.getZoomLevel()/100),y:(e.y-this.diagramModel.getOffsetY())/(this.diagramModel.getZoomLevel()/100)}},e.prototype.getRelativePoint=function(t,e){var o=this.canvas.getBoundingClientRect();return{x:t-o.left,y:e-o.top}},e.prototype.getNodeElement=function(t){var e=this.canvas.querySelector('.node[data-nodeid="'+t.getID()+'"]');if(null===e)throw new Error("Cannot find Node element with nodeID: ["+t.getID()+"]");return e},e.prototype.getNodePortElement=function(t){var e=this.canvas.querySelector('.port[data-name="'+t.getName()+'"][data-nodeid="'+t.getParent().getID()+'"]');if(null===e)throw new Error("Cannot find Node Port element with nodeID: ["+t.getParent().getID()+"] and name: ["+t.getName()+"]");return e},e.prototype.getPortCenter=function(t){var e=this.getNodePortElement(t),o=e.getBoundingClientRect(),n=this.getRelativePoint(o.left,o.top);return{x:e.offsetWidth/2+(n.x-this.diagramModel.getOffsetX())/(this.diagramModel.getZoomLevel()/100),y:e.offsetHeight/2+(n.y-this.diagramModel.getOffsetY())/(this.diagramModel.getZoomLevel()/100)}},e.prototype.getPortCoords=function(t){var e=this.getNodePortElement(t).getBoundingClientRect(),o=this.canvas.getBoundingClientRect();return{x:(e.x-this.diagramModel.getOffsetX())/(this.diagramModel.getZoomLevel()/100)-o.left,y:(e.y-this.diagramModel.getOffsetY())/(this.diagramModel.getZoomLevel()/100)-o.top,width:e.width,height:e.height}},e.prototype.getNodeDimensions=function(t){if(!this.canvas)return{width:0,height:0};var e=this.getNodeElement(t).getBoundingClientRect();return{width:e.width,height:e.height}},e.prototype.getMaxNumberPointsPerLink=function(){return this.maxNumberPointsPerLink},e.prototype.setMaxNumberPointsPerLink=function(t){this.maxNumberPointsPerLink=t},e.prototype.isSmartRoutingEnabled=function(){return!!this.smartRouting},e.prototype.setSmartRoutingStatus=function(t){this.smartRouting=t},e.prototype.getCanvasMatrix=function(){return 0===this.canvasMatrix.length&&this.calculateCanvasMatrix(),this.canvasMatrix},e.prototype.calculateCanvasMatrix=function(){var t=this.calculateMatrixDimensions(),e=t.width,o=t.hAdjustmentFactor,n=t.height,i=t.vAdjustmentFactor;this.hAdjustmentFactor=o,this.vAdjustmentFactor=i;var r=Math.ceil(e/u.ROUTING_SCALING_FACTOR),s=Math.ceil(n/u.ROUTING_SCALING_FACTOR);this.canvasMatrix=a.range(0,s).map((function(){return new Array(r).fill(0)}))},e.prototype.getRoutingMatrix=function(){return 0===this.routingMatrix.length&&this.calculateRoutingMatrix(),this.routingMatrix},e.prototype.calculateRoutingMatrix=function(){var t=a.cloneDeep(this.getCanvasMatrix());this.markNodes(t),this.markPorts(t),this.routingMatrix=t},e.prototype.translateRoutingX=function(t,e){return void 0===e&&(e=!1),t+this.hAdjustmentFactor*(e?-1:1)},e.prototype.translateRoutingY=function(t,e){return void 0===e&&(e=!1),t+this.vAdjustmentFactor*(e?-1:1)},e.prototype.zoomToFit=function(){var t=this.canvas.clientWidth/this.canvas.scrollWidth,e=this.canvas.clientHeight/this.canvas.scrollHeight,o=t<e?t:e;this.diagramModel.setZoomLevel(this.diagramModel.getZoomLevel()*o),this.diagramModel.setOffset(0,0),this.repaintCanvas()},e}(r.BaseEntity);e.DiagramEngine=g},703:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Toolkit=void 0;var n=o(408),i=o(443),r=o(723),s=function(){function t(){}return t.UID=function(){return t.TESTING?(t.TESTING_UID++,""+t.TESTING_UID):"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},t.closest=function(t,e){return document.body.closest?t.closest(e):n(t,e)},t.generateLinePath=function(t,e){return"M"+t.x+","+t.y+" L "+e.x+","+e.y},t.generateCurvePath=function(t,e,o){void 0===o&&(o=0);var n=Math.abs(t.x-e.x)>Math.abs(t.y-e.y),i=n?o:0,r=n?0:o;return"M"+t.x+","+t.y+" C "+(t.x+i)+","+(t.y+r)+"\n    "+(e.x-i)+","+(e.y-r)+" "+e.x+","+e.y},t.generateDynamicPath=function(t){var e=r();return e=e.moveto(t[0][0]*i.ROUTING_SCALING_FACTOR,t[0][1]*i.ROUTING_SCALING_FACTOR),t.slice(1).forEach((function(t){e=e.lineto(t[0]*i.ROUTING_SCALING_FACTOR,t[1]*i.ROUTING_SCALING_FACTOR)})),e.print()},t.TESTING=!1,t.TESTING_UID=0,t}();e.Toolkit=s},933:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseAction=void 0;var o=function(t,e){this.mouseX=t,this.mouseY=e,this.ms=(new Date).getTime()};e.BaseAction=o},747:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.MoveCanvasAction=void 0;var r=function(t){function e(e,o,n){var i=t.call(this,e,o)||this;return i.initialOffsetX=n.getOffsetX(),i.initialOffsetY=n.getOffsetY(),i}return i(e,t),e}(o(933).BaseAction);e.MoveCanvasAction=r},665:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.MoveItemsAction=void 0;var r=function(t){function e(e,o,n){var i=t.call(this,e,o)||this;i.moved=!1,n.enableRepaintEntities(n.getDiagramModel().getSelectedItems());var r=n.getDiagramModel().getSelectedItems();return r=r.filter((function(t){return!n.isModelLocked(t)})),i.selectionModels=r.map((function(t){return{model:t,initialX:t.x,initialY:t.y}})),i}return i(e,t),e}(o(933).BaseAction);e.MoveItemsAction=r},413:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.SelectingAction=void 0;var r=function(t){function e(e,o){var n=t.call(this,e,o)||this;return n.mouseX2=e,n.mouseY2=o,n}return i(e,t),e.prototype.getBoxDimensions=function(){return{left:this.mouseX2>this.mouseX?this.mouseX:this.mouseX2,top:this.mouseY2>this.mouseY?this.mouseY:this.mouseY2,width:Math.abs(this.mouseX2-this.mouseX),height:Math.abs(this.mouseY2-this.mouseY),right:this.mouseX2<this.mouseX?this.mouseX:this.mouseX2,bottom:this.mouseY2<this.mouseY?this.mouseY:this.mouseY2}},e.prototype.containsElement=function(t,e,o){var n=o.getZoomLevel()/100,i=this.getBoxDimensions();return t*n+o.getOffsetX()>i.left&&t*n+o.getOffsetX()<i.right&&e*n+o.getOffsetY()>i.top&&e*n+o.getOffsetY()<i.bottom},e}(o(933).BaseAction);e.SelectingAction=r},294:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultLabelFactory=void 0;var r=o(297),s=o(335),a=o(797),c=o(871),p=function(t){function e(){return t.call(this,"default")||this}return i(e,t),e.prototype.generateReactWidget=function(t,e){return r.createElement(c.DefaultLabelWidget,{model:e})},e.prototype.getNewInstance=function(t){return new a.DefaultLabelModel},e}(s.AbstractLabelFactory);e.DefaultLabelFactory=p},218:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultLinkFactory=void 0;var r=o(297),s=o(963),a=o(196),c=o(388),p=function(t){function e(){return t.call(this,"default")||this}return i(e,t),e.prototype.generateReactWidget=function(t,e){return r.createElement(s.DefaultLinkWidget,{link:e,diagramEngine:t})},e.prototype.getNewInstance=function(t){return new c.DefaultLinkModel},e.prototype.generateLinkSegment=function(t,e,o,n){return r.createElement("path",{className:o?e.bem("--path-selected"):"",strokeWidth:t.width,stroke:t.color,d:n})},e}(a.AbstractLinkFactory);e.DefaultLinkFactory=p},669:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultNodeFactory=void 0;var r=o(813),s=o(297),a=o(784),c=function(t){function e(){return t.call(this,"default")||this}return i(e,t),e.prototype.generateReactWidget=function(t,e){return s.createElement(a.DefaultNodeWidget,{node:e,diagramEngine:t})},e.prototype.getNewInstance=function(t){return new r.DefaultNodeModel},e}(o(544).AbstractNodeFactory);e.DefaultNodeFactory=c},165:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultPortFactory=void 0;var r=o(668),s=function(t){function e(){return t.call(this,"default")||this}return i(e,t),e.prototype.getNewInstance=function(t){return new r.DefaultPortModel(!0,"unknown")},e}(o(498).AbstractPortFactory);e.DefaultPortFactory=s},797:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultLabelModel=void 0;var r=function(t){function e(){var e=t.call(this,"default")||this;return e.offsetY=-23,e}return i(e,t),e.prototype.setLabel=function(t){this.label=t},e}(o(51).LabelModel);e.DefaultLabelModel=r},388:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultLinkModel=void 0;var s=o(245),a=o(804),c=o(797),p=o(51),l=function(t){function e(e){void 0===e&&(e="default");var o=t.call(this,e)||this;return o.color="rgba(255,255,255,0.5)",o.width=3,o.curvyness=50,o}return i(e,t),e.prototype.serialize=function(){return a.merge(t.prototype.serialize.call(this),{width:this.width,color:this.color,curvyness:this.curvyness})},e.prototype.deSerialize=function(e,o){t.prototype.deSerialize.call(this,e,o),this.color=e.color,this.width=e.width,this.curvyness=e.curvyness},e.prototype.addLabel=function(e){if(e instanceof p.LabelModel)return t.prototype.addLabel.call(this,e);var o=new c.DefaultLabelModel;return o.setLabel(e),t.prototype.addLabel.call(this,o)},e.prototype.setWidth=function(t){this.width=t,this.iterateListeners((function(e,o){e.widthChanged&&e.widthChanged(r(r({},o),{width:t}))}))},e.prototype.setColor=function(t){this.color=t,this.iterateListeners((function(e,o){e.colorChanged&&e.colorChanged(r(r({},o),{color:t}))}))},e}(s.LinkModel);e.DefaultLinkModel=l},813:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultNodeModel=void 0;var r=o(668),s=o(804),a=o(941),c=o(703),p=function(t){function e(e,o){void 0===e&&(e="Untitled"),void 0===o&&(o="rgb(0,192,255)");var n=t.call(this,"default")||this;return n.name=e,n.color=o,n}return i(e,t),e.prototype.addInPort=function(t){return this.addPort(new r.DefaultPortModel(!0,c.Toolkit.UID(),t))},e.prototype.addOutPort=function(t){return this.addPort(new r.DefaultPortModel(!1,c.Toolkit.UID(),t))},e.prototype.deSerialize=function(e,o){t.prototype.deSerialize.call(this,e,o),this.name=e.name,this.color=e.color},e.prototype.serialize=function(){return s.merge(t.prototype.serialize.call(this),{name:this.name,color:this.color})},e.prototype.getInPorts=function(){return s.filter(this.ports,(function(t){return t.in}))},e.prototype.getOutPorts=function(){return s.filter(this.ports,(function(t){return!t.in}))},e}(a.NodeModel);e.DefaultNodeModel=p},668:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultPortModel=void 0;var r=o(804),s=o(72),a=o(388),c=function(t){function e(e,o,n,i){void 0===n&&(n=null);var r=t.call(this,o,"default",i)||this;return r.in=e,r.label=n||o,r}return i(e,t),e.prototype.deSerialize=function(e,o){t.prototype.deSerialize.call(this,e,o),this.in=e.in,this.label=e.label},e.prototype.serialize=function(){return r.merge(t.prototype.serialize.call(this),{in:this.in,label:this.label})},e.prototype.link=function(t){var e=this.createLinkModel();return e.setSourcePort(this),e.setTargetPort(t),e},e.prototype.canLinkToPort=function(t){return!(t instanceof e)||this.in!==t.in},e.prototype.createLinkModel=function(){return t.prototype.createLinkModel.call(this)||new a.DefaultLinkModel},e}(s.PortModel);e.DefaultPortModel=c},871:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultLabelWidget=void 0;var s=o(297),a=function(t){function e(e){return t.call(this,"srd-default-label",e)||this}return i(e,t),e.prototype.render=function(){return s.createElement("div",r({},this.getProps()),this.props.model.label)},e}(o(359).BaseWidget);e.DefaultLabelWidget=a},963:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultLinkWidget=void 0;var s=o(297),a=o(556),c=o(703),p=o(443),l=o(804),u=function(t){function e(e){var o=t.call(this,"srd-default-link",e)||this;return o.addPointToLink=function(t,e){if(!t.shiftKey&&!o.props.diagramEngine.isModelLocked(o.props.link)&&o.props.link.points.length-1<=o.props.diagramEngine.getMaxNumberPointsPerLink()){var n=new a.PointModel(o.props.link,o.props.diagramEngine.getRelativeMousePoint(t));n.setSelected(!0),o.forceUpdate(),o.props.link.addPoint(n,e),o.props.pointAdded(n,t)}},o.findPathAndRelativePositionToRenderLabel=function(t){for(var e=o.refPaths.map((function(t){return t.getTotalLength()})),n=e.reduce((function(t,e){return t+e}),0)*(t/(o.props.link.labels.length+1)),i=0;i<o.refPaths.length;){if(n-e[i]<0)return{path:o.refPaths[i],position:n};n-=e[i],i++}},o.calculateLabelPosition=function(t,e){if(o.refLabels[t.id]){var n=o.findPathAndRelativePositionToRenderLabel(e),i=n.path,r=n.position,s=o.refLabels[t.id].offsetWidth,a=o.refLabels[t.id].offsetHeight,c=i.getPointAtLength(r),p=c.x-s/2+t.offsetX,l=c.y-a/2+t.offsetY;o.refLabels[t.id].setAttribute("style","transform: translate("+p+"px, "+l+"px);")}},o.refLabels={},o.refPaths=[],o.state={selected:!1},e.diagramEngine.isSmartRoutingEnabled()&&(o.pathFinding=new p.default(o.props.diagramEngine)),o}return i(e,t),e.prototype.calculateAllLabelPosition=function(){var t=this;l.forEach(this.props.link.labels,(function(e,o){t.calculateLabelPosition(e,o+1)}))},e.prototype.componentDidUpdate=function(){this.props.link.labels.length>0&&window.requestAnimationFrame(this.calculateAllLabelPosition.bind(this))},e.prototype.componentDidMount=function(){this.props.link.labels.length>0&&window.requestAnimationFrame(this.calculateAllLabelPosition.bind(this))},e.prototype.generatePoint=function(t){var e=this,o=this.props.link.points[t].x,n=this.props.link.points[t].y;return s.createElement("g",{key:"point-"+this.props.link.points[t].id},s.createElement("circle",{cx:o,cy:n,r:5,className:"point "+this.bem("__point")+(this.props.link.points[t].isSelected()?this.bem("--point-selected"):"")}),s.createElement("circle",{onMouseLeave:function(){e.setState({selected:!1})},onMouseEnter:function(){e.setState({selected:!0})},"data-id":this.props.link.points[t].id,"data-linkid":this.props.link.id,cx:o,cy:n,r:15,opacity:0,className:"point "+this.bem("__point")}))},e.prototype.generateLabel=function(t){var e=this,o=this.props.diagramEngine.canvas;return s.createElement("foreignObject",{key:t.id,className:this.bem("__label"),width:o.offsetWidth,height:o.offsetHeight},s.createElement("div",{ref:function(o){return e.refLabels[t.id]=o}},this.props.diagramEngine.getFactoryForLabel(t).generateReactWidget(this.props.diagramEngine,t)))},e.prototype.generateLink=function(t,e,o){var n=this,i=this.props,a=s.cloneElement(i.diagramEngine.getFactoryForLink(this.props.link).generateLinkSegment(this.props.link,this,this.state.selected||this.props.link.isSelected(),t),{ref:function(t){return t&&n.refPaths.push(t)}}),c=s.cloneElement(a,r(r({},e),{strokeLinecap:"round",onMouseLeave:function(){n.setState({selected:!1})},onMouseEnter:function(){n.setState({selected:!0})},ref:null,"data-linkid":this.props.link.getID(),strokeOpacity:this.state.selected?.1:0,strokeWidth:20,onContextMenu:function(){}}));return s.createElement("g",{key:"link-"+o},a,c)},e.prototype.isSmartRoutingApplicable=function(){var t=this.props,e=t.diagramEngine,o=t.link;return!!e.isSmartRoutingEnabled()&&(2===o.points.length&&(null!==o.sourcePort&&null!==o.targetPort))},e.prototype.render=function(){var t=this,e=this.props.diagramEngine;if(!e.nodesRendered)return null;var o=this.props.link.points,n=[];if(this.isSmartRoutingApplicable()){var i=this.pathFinding.calculateDirectPath(l.first(o),l.last(o)),a=e.getRoutingMatrix(),p=this.pathFinding.calculateLinkStartEndCoords(a,i);if(p){var u=p.start,d=p.end,f=p.pathToStart,h=p.pathToEnd,g=this.pathFinding.calculateDynamicPath(a,u,d,f,h);n.push(this.generateLink(c.Toolkit.generateDynamicPath(g),{onMouseDown:function(e){t.addPointToLink(e,1)}},"0"))}}if(0===n.length)if(2===o.length){var y=Math.abs(o[0].x-o[1].x)>Math.abs(o[0].y-o[1].y)?"x":"y";Math.abs(o[0][y]-o[1][y])<50&&5;var m=o[0],v=o[1];m[y]>v[y]&&(m=o[1],v=o[0]),n.push(this.generateLink(c.Toolkit.generateCurvePath(m,v,this.props.link.curvyness),{onMouseDown:function(e){t.addPointToLink(e,1)}},"0")),null===this.props.link.targetPort&&n.push(this.generatePoint(1))}else{for(var _=function(e){n.push(P.generateLink(c.Toolkit.generateLinePath(o[e],o[e+1]),{"data-linkid":P.props.link.id,"data-point":e,onMouseDown:function(o){t.addPointToLink(o,e+1)}},e))},P=this,b=0;b<o.length-1;b++)_(b);for(var O=1;O<o.length-1;O++)n.push(this.generatePoint(O));null===this.props.link.targetPort&&n.push(this.generatePoint(o.length-1))}return this.refPaths=[],s.createElement("g",r({},this.getProps()),n,l.map(this.props.link.labels,(function(e){return t.generateLabel(e)})))},e.defaultProps={color:"black",width:3,link:null,engine:null,smooth:!1,diagramEngine:null},e}(o(359).BaseWidget);e.DefaultLinkWidget=u},784:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultNodeWidget=void 0;var s=o(297),a=o(804),c=o(353),p=function(t){function e(e){var o=t.call(this,"srd-default-node",e)||this;return o.state={},o}return i(e,t),e.prototype.generatePort=function(t){return s.createElement(c.DefaultPortLabel,{model:t,key:t.id})},e.prototype.render=function(){return s.createElement("div",r({},this.getProps(),{style:{background:this.props.node.color}}),s.createElement("div",{className:this.bem("__title")},s.createElement("div",{className:this.bem("__name")},this.props.node.name)),s.createElement("div",{className:this.bem("__ports")},s.createElement("div",{className:this.bem("__in")},a.map(this.props.node.getInPorts(),this.generatePort.bind(this))),s.createElement("div",{className:this.bem("__out")},a.map(this.props.node.getOutPorts(),this.generatePort.bind(this)))))},e}(o(359).BaseWidget);e.DefaultNodeWidget=p},353:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultPortLabel=void 0;var s=o(297),a=o(94),c=function(t){function e(e){return t.call(this,"srd-default-port",e)||this}return i(e,t),e.prototype.getClassName=function(){return t.prototype.getClassName.call(this)+(this.props.model.in?this.bem("--in"):this.bem("--out"))},e.prototype.render=function(){var t=s.createElement(a.PortWidget,{node:this.props.model.getParent(),name:this.props.model.name}),e=s.createElement("div",{className:"name"},this.props.model.label);return s.createElement("div",r({},this.getProps()),this.props.model.in?t:e,this.props.model.in?e:t)},e}(o(359).BaseWidget);e.DefaultPortLabel=c},10:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractFactory=void 0;var o=function(){function t(t){this.type=t}return t.prototype.getType=function(){return this.type},t}();e.AbstractFactory=o},335:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractLabelFactory=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(o(10).AbstractFactory);e.AbstractLabelFactory=r},196:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractLinkFactory=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(o(10).AbstractFactory);e.AbstractLinkFactory=r},544:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractNodeFactory=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(o(10).AbstractFactory);e.AbstractNodeFactory=r},498:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractPortFactory=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(o(10).AbstractFactory);e.AbstractPortFactory=r},519:function(t,e,o){var n=this&&this.__createBinding||(Object.create?function(t,e,o,n){void 0===n&&(n=o),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]}),i=this&&this.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||n(e,t,o)};Object.defineProperty(e,"__esModule",{value:!0}),i(o(703),e),i(o(264),e),i(o(5),e),i(o(813),e),i(o(668),e),i(o(388),e),i(o(797),e),i(o(218),e),i(o(669),e),i(o(165),e),i(o(294),e),i(o(963),e),i(o(871),e),i(o(784),e),i(o(353),e),i(o(10),e),i(o(335),e),i(o(196),e),i(o(544),e),i(o(498),e),i(o(443),e),i(o(933),e),i(o(747),e),i(o(665),e),i(o(413),e),i(o(329),e),i(o(560),e),i(o(946),e),i(o(245),e),i(o(941),e),i(o(556),e),i(o(72),e),i(o(51),e),i(o(983),e),i(o(279),e),i(o(546),e),i(o(94),e),i(o(359),e),i(o(119),e),i(o(173),e)},560:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseModel=void 0;var s=o(264),a=o(804),c=function(t){function e(e,o){var n=t.call(this,o)||this;return n.type=e,n.selected=!1,n}return i(e,t),e.prototype.getParent=function(){return this.parent},e.prototype.setParent=function(t){this.parent=t},e.prototype.getSelectedEntities=function(){return this.isSelected()?[this]:[]},e.prototype.deSerialize=function(e,o){t.prototype.deSerialize.call(this,e,o),this.type=e.type,this.selected=e.selected},e.prototype.serialize=function(){return a.merge(t.prototype.serialize.call(this),{type:this.type,selected:this.selected})},e.prototype.getType=function(){return this.type},e.prototype.getID=function(){return this.id},e.prototype.isSelected=function(){return this.selected},e.prototype.setSelected=function(t){void 0===t&&(t=!0),this.selected=t,this.iterateListeners((function(e,o){e.selectionChanged&&e.selectionChanged(r(r({},o),{isSelected:t}))}))},e.prototype.remove=function(){this.iterateListeners((function(t,e){t.entityRemoved&&t.entityRemoved(e)}))},e}(s.BaseEntity);e.BaseModel=c},946:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramModel=void 0;var s=o(264),a=o(804),c=o(245),p=o(941),l=o(72),u=o(556),d=function(t){function e(){var e=t.call(this)||this;return e.links={},e.nodes={},e.offsetX=0,e.offsetY=0,e.zoom=100,e.rendered=!1,e.gridSize=0,e.isCanvasMoving=!1,e}return i(e,t),e.prototype.setGridSize=function(t){void 0===t&&(t=0),this.gridSize=t,this.iterateListeners((function(e,o){e.gridUpdated&&e.gridUpdated(r(r({},o),{size:t}))}))},e.prototype.getGridPosition=function(t){return 0===this.gridSize?t:this.gridSize*Math.floor((t+this.gridSize/2)/this.gridSize)},e.prototype.deSerializeDiagram=function(t,e){var o=this;this.deSerialize(t,e),this.offsetX=t.offsetX,this.offsetY=t.offsetY,this.zoom=t.zoom,this.gridSize=t.gridSize,this.isCanvasMoving=t.isCanvasMoving,a.forEach(t.nodes,(function(t){var n=e.getNodeFactory(t.type).getNewInstance(t);n.setParent(o),n.deSerialize(t,e),o.addNode(n)})),a.forEach(t.links,(function(t){var n=e.getLinkFactory(t.type).getNewInstance();n.setParent(o),n.deSerialize(t,e),o.addLink(n)}))},e.prototype.serializeDiagram=function(){return a.merge(this.serialize(),{offsetX:this.offsetX,offsetY:this.offsetY,zoom:this.zoom,gridSize:this.gridSize,links:a.map(this.links,(function(t){return t.serialize()})),nodes:a.map(this.nodes,(function(t){return t.serialize()})),isCanvasMoving:this.isCanvasMoving})},e.prototype.clearSelection=function(t){void 0===t&&(t=null),a.forEach(this.getSelectedItems(),(function(e){t&&t.getID()===e.getID()||e.setSelected(!1)}))},e.prototype.getSelectedItems=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Array.isArray(t)||(t=[t]);var o=[];return o=(o=(o=o.concat(a.flatMap(this.nodes,(function(t){return t.getSelectedEntities()})))).concat(a.flatMap(this.links,(function(t){return t.getSelectedEntities()})))).concat(a.flatMap(this.links,(function(t){return a.flatMap(t.points,(function(t){return t.getSelectedEntities()}))}))),o=a.uniq(o),t.length>0&&(o=a.filter(a.uniq(o),(function(e){return!!(a.includes(t,"node")&&e instanceof p.NodeModel)||(!!(a.includes(t,"link")&&e instanceof c.LinkModel)||(!!(a.includes(t,"port")&&e instanceof l.PortModel)||!!(a.includes(t,"point")&&e instanceof u.PointModel)))}))),o},e.prototype.setZoomLevel=function(t){this.zoom=t>300?300:t<15?15:t,this.iterateListeners((function(e,o){e.zoomUpdated&&e.zoomUpdated(r(r({},o),{zoom:t}))}))},e.prototype.setIsCanvasMoving=function(t){this.isCanvasMoving=t},e.prototype.setOffset=function(t,e){this.offsetX=t,this.offsetY=e,this.iterateListeners((function(o,n){o.offsetUpdated&&o.offsetUpdated(r(r({},n),{offsetX:t,offsetY:e}))}))},e.prototype.setOffsetX=function(t){var e=this;this.offsetX=t,this.iterateListeners((function(o,n){o.offsetUpdated&&o.offsetUpdated(r(r({},n),{offsetX:t,offsetY:e.offsetY}))}))},e.prototype.setOffsetY=function(t){var e=this;this.offsetY=t,this.iterateListeners((function(t,o){t.offsetUpdated&&t.offsetUpdated(r(r({},o),{offsetX:e.offsetX,offsetY:e.offsetY}))}))},e.prototype.getOffsetY=function(){return this.offsetY},e.prototype.getOffsetX=function(){return this.offsetX},e.prototype.getIsCanvasMoving=function(){return this.isCanvasMoving},e.prototype.getZoomLevel=function(){return this.zoom},e.prototype.getNode=function(t){return t instanceof p.NodeModel?t:this.nodes[t]?this.nodes[t]:null},e.prototype.getLink=function(t){return t instanceof c.LinkModel?t:this.links[t]?this.links[t]:null},e.prototype.addAll=function(){for(var t=this,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return a.forEach(e,(function(e){e instanceof c.LinkModel?t.addLink(e):e instanceof p.NodeModel&&t.addNode(e)})),e},e.prototype.addLink=function(t){var e=this;return t.addListener({entityRemoved:function(){e.removeLink(t)}}),this.links[t.getID()]=t,this.iterateListeners((function(e,o){e.linksUpdated&&e.linksUpdated(r(r({},o),{link:t,isCreated:!0}))})),t},e.prototype.addNode=function(t){var e=this;return t.addListener({entityRemoved:function(){e.removeNode(t)}}),this.nodes[t.getID()]=t,this.iterateListeners((function(e,o){e.nodesUpdated&&e.nodesUpdated(r(r({},o),{node:t,isCreated:!0}))})),t},e.prototype.removeLink=function(t){t=this.getLink(t),delete this.links[t.getID()],this.iterateListeners((function(e,o){e.linksUpdated&&e.linksUpdated(r(r({},o),{link:t,isCreated:!1}))}))},e.prototype.removeNode=function(t){t=this.getNode(t),delete this.nodes[t.getID()],this.iterateListeners((function(e,o){e.nodesUpdated&&e.nodesUpdated(r(r({},o),{node:t,isCreated:!1}))}))},e.prototype.getLinks=function(){return this.links},e.prototype.getNodes=function(){return this.nodes},e}(s.BaseEntity);e.DiagramModel=d},51:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.LabelModel=void 0;var r=function(t){function e(e,o){var n=t.call(this,e,o)||this;return n.offsetX=0,n.offsetY=0,n}return i(e,t),e}(o(560).BaseModel);e.LabelModel=r},245:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.LinkModel=void 0;var s=o(560),a=o(556),c=o(804),p=function(t){function e(e,o){void 0===e&&(e="default");var n=t.call(this,e,o)||this;return n.points=[new a.PointModel(n,{x:0,y:0}),new a.PointModel(n,{x:0,y:0})],n.extras={},n.sourcePort=null,n.targetPort=null,n.labels=[],n}return i(e,t),e.prototype.deSerialize=function(e,o){var n=this;t.prototype.deSerialize.call(this,e,o),this.extras=e.extras,this.points=c.map(e.points||[],(function(t){var e=new a.PointModel(n,{x:t.x,y:t.y});return e.deSerialize(t,o),e})),c.forEach(e.labels||[],(function(t){var e=o.getLabelFactory(t.type).getNewInstance();e.deSerialize(t,o),n.addLabel(e)})),e.target&&this.setTargetPort(this.getParent().getNode(e.target).getPortFromID(e.targetPort)),e.source&&this.setSourcePort(this.getParent().getNode(e.source).getPortFromID(e.sourcePort))},e.prototype.serialize=function(){return c.merge(t.prototype.serialize.call(this),{source:this.sourcePort?this.sourcePort.getParent().id:null,sourcePort:this.sourcePort?this.sourcePort.id:null,target:this.targetPort?this.targetPort.getParent().id:null,targetPort:this.targetPort?this.targetPort.id:null,points:c.map(this.points,(function(t){return t.serialize()})),extras:this.extras,labels:c.map(this.labels,(function(t){return t.serialize()}))})},e.prototype.doClone=function(t,e){void 0===t&&(t={}),e.setPoints(c.map(this.getPoints(),(function(e){return e.clone(t)}))),this.sourcePort&&e.setSourcePort(this.sourcePort.clone(t)),this.targetPort&&e.setTargetPort(this.targetPort.clone(t))},e.prototype.remove=function(){this.sourcePort&&this.sourcePort.removeLink(this),this.targetPort&&this.targetPort.removeLink(this),t.prototype.remove.call(this)},e.prototype.isLastPoint=function(t){return this.getPointIndex(t)===this.points.length-1},e.prototype.getPointIndex=function(t){return this.points.indexOf(t)},e.prototype.getPointModel=function(t){for(var e=0;e<this.points.length;e++)if(this.points[e].id===t)return this.points[e];return null},e.prototype.getPortForPoint=function(t){return null!==this.sourcePort&&this.getFirstPoint().getID()===t.getID()?this.sourcePort:null!==this.targetPort&&this.getLastPoint().getID()===t.getID()?this.targetPort:null},e.prototype.getPointForPort=function(t){return null!==this.sourcePort&&this.sourcePort.getID()===t.getID()?this.getFirstPoint():null!==this.targetPort&&this.targetPort.getID()===t.getID()?this.getLastPoint():null},e.prototype.getFirstPoint=function(){return this.points[0]},e.prototype.getLastPoint=function(){return this.points[this.points.length-1]},e.prototype.setSourcePort=function(t){null!==t&&t.addLink(this),null!==this.sourcePort&&this.sourcePort.removeLink(this),this.sourcePort=t,this.iterateListeners((function(e,o){e.sourcePortChanged&&e.sourcePortChanged(r(r({},o),{port:t}))}))},e.prototype.getSourcePort=function(){return this.sourcePort},e.prototype.getTargetPort=function(){return this.targetPort},e.prototype.setTargetPort=function(t){null!==t&&t.addLink(this),null!==this.targetPort&&this.targetPort.removeLink(this),this.targetPort=t,this.iterateListeners((function(e,o){e.targetPortChanged&&e.targetPortChanged(r(r({},o),{port:t}))}))},e.prototype.point=function(t,e){return this.addPoint(this.generatePoint(t,e))},e.prototype.addLabel=function(t){t.setParent(this),this.labels.push(t)},e.prototype.getPoints=function(){return this.points},e.prototype.setPoints=function(t){var e=this;c.forEach(t,(function(t){t.setParent(e)})),this.points=t},e.prototype.removePoint=function(t){this.points.splice(this.getPointIndex(t),1)},e.prototype.removePointsBefore=function(t){this.points.splice(0,this.getPointIndex(t))},e.prototype.removePointsAfter=function(t){this.points.splice(this.getPointIndex(t)+1)},e.prototype.removeMiddlePoints=function(){this.points.length>2&&this.points.splice(0,this.points.length-2)},e.prototype.addPoint=function(t,e){return void 0===e&&(e=1),t.setParent(this),this.points.splice(e,0,t),t},e.prototype.generatePoint=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new a.PointModel(this,{x:t,y:e})},e}(s.BaseModel);e.LinkModel=p},941:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.NodeModel=void 0;var r=o(560),s=o(804),a=function(t){function e(e,o){void 0===e&&(e="default");var n=t.call(this,e,o)||this;return n.x=0,n.y=0,n.extras={},n.ports={},n}return i(e,t),e.prototype.setPosition=function(t,e){var o=this.x,n=this.y;s.forEach(this.ports,(function(i){s.forEach(i.getLinks(),(function(r){var s=r.getPointForPort(i);s.x=s.x+t-o,s.y=s.y+e-n}))})),this.x=t,this.y=e},e.prototype.getSelectedEntities=function(){var e=t.prototype.getSelectedEntities.call(this);return this.isSelected()&&s.forEach(this.ports,(function(t){e=e.concat(s.map(t.getLinks(),(function(e){return e.getPointForPort(t)})))})),e},e.prototype.deSerialize=function(e,o){var n=this;t.prototype.deSerialize.call(this,e,o),this.x=e.x,this.y=e.y,this.extras=e.extras,s.forEach(e.ports,(function(t){var e=o.getPortFactory(t.type).getNewInstance();e.deSerialize(t,o),n.addPort(e)}))},e.prototype.serialize=function(){return s.merge(t.prototype.serialize.call(this),{x:this.x,y:this.y,extras:this.extras,ports:s.map(this.ports,(function(t){return t.serialize()}))})},e.prototype.doClone=function(t,e){void 0===t&&(t={}),e.ports={},s.forEach(this.ports,(function(o){e.addPort(o.clone(t))}))},e.prototype.remove=function(){t.prototype.remove.call(this),s.forEach(this.ports,(function(t){s.forEach(t.getLinks(),(function(t){t.remove()}))}))},e.prototype.getPortFromID=function(t){for(var e in this.ports)if(this.ports[e].id===t)return this.ports[e];return null},e.prototype.getPort=function(t){return this.ports[t]},e.prototype.getPorts=function(){return this.ports},e.prototype.removePort=function(t){this.ports[t.name]&&(this.ports[t.name].setParent(null),delete this.ports[t.name])},e.prototype.addPort=function(t){return t.setParent(this),this.ports[t.name]=t,t},e.prototype.updateDimensions=function(t){var e=t.width,o=t.height;this.width=e,this.height=o},e}(r.BaseModel);e.NodeModel=a},556:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.PointModel=void 0;var r=o(560),s=o(804),a=function(t){function e(e,o){var n=t.call(this)||this;return n.x=o.x,n.y=o.y,n.parent=e,n}return i(e,t),e.prototype.getSelectedEntities=function(){return t.prototype.isSelected.call(this)&&!this.isConnectedToPort()?[this]:[]},e.prototype.isConnectedToPort=function(){return null!==this.parent.getPortForPoint(this)},e.prototype.getLink=function(){return this.getParent()},e.prototype.deSerialize=function(e,o){t.prototype.deSerialize.call(this,e,o),this.x=e.x,this.y=e.y},e.prototype.serialize=function(){return s.merge(t.prototype.serialize.call(this),{x:this.x,y:this.y})},e.prototype.remove=function(){this.parent&&this.parent.removePoint(this),t.prototype.remove.call(this)},e.prototype.updateLocation=function(t){this.x=t.x,this.y=t.y},e.prototype.getX=function(){return this.x},e.prototype.getY=function(){return this.y},e.prototype.isLocked=function(){return t.prototype.isLocked.call(this)||this.getParent().isLocked()},e}(r.BaseModel);e.PointModel=a},72:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.PortModel=void 0;var r=o(560),s=o(804),a=function(t){function e(e,o,n,i){var r=t.call(this,o,n)||this;return r.name=e,r.links={},r.maximumLinks=i,r}return i(e,t),e.prototype.deSerialize=function(e,o){t.prototype.deSerialize.call(this,e,o),this.name=e.name,this.maximumLinks=e.maximumLinks},e.prototype.serialize=function(){return s.merge(t.prototype.serialize.call(this),{name:this.name,parentNode:this.parent.id,links:s.map(this.links,(function(t){return t.id})),maximumLinks:this.maximumLinks})},e.prototype.doClone=function(t,e){void 0===t&&(t={}),e.links={},e.parentNode=this.getParent().clone(t)},e.prototype.getNode=function(){return this.getParent()},e.prototype.getName=function(){return this.name},e.prototype.getMaximumLinks=function(){return this.maximumLinks},e.prototype.setMaximumLinks=function(t){this.maximumLinks=t},e.prototype.removeLink=function(t){delete this.links[t.getID()]},e.prototype.addLink=function(t){this.links[t.getID()]=t},e.prototype.getLinks=function(){return this.links},e.prototype.createLinkModel=function(){if(s.isFinite(this.maximumLinks)){var t=s.size(this.links);if(1===this.maximumLinks&&t>=1)return s.values(this.links)[0];if(t>=this.maximumLinks)return null}return null},e.prototype.updateCoords=function(t){var e=t.x,o=t.y,n=t.width,i=t.height;this.x=e,this.y=o,this.width=n,this.height=i},e.prototype.canLinkToPort=function(t){return!0},e.prototype.isLocked=function(){return t.prototype.isLocked.call(this)||this.getParent().isLocked()},e}(r.BaseModel);e.PortModel=a},329:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},443:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ROUTING_SCALING_FACTOR=void 0;var n=o(500);e.ROUTING_SCALING_FACTOR=5;var i=new n.JumpPointFinder({heuristic:n.Heuristic.manhattan,diagonalMovement:n.DiagonalMovement.Never}),r=function(){function t(t){this.instance=i,this.diagramEngine=t}return t.prototype.calculateDirectPath=function(t,o){var r=this.diagramEngine.getCanvasMatrix(),s=new n.Grid(r);return i.findPath(this.diagramEngine.translateRoutingX(Math.floor(t.x/e.ROUTING_SCALING_FACTOR)),this.diagramEngine.translateRoutingY(Math.floor(t.y/e.ROUTING_SCALING_FACTOR)),this.diagramEngine.translateRoutingX(Math.floor(o.x/e.ROUTING_SCALING_FACTOR)),this.diagramEngine.translateRoutingY(Math.floor(o.y/e.ROUTING_SCALING_FACTOR)),s)},t.prototype.calculateLinkStartEndCoords=function(t,e){var o=e.findIndex((function(e){return 0===t[e[1]][e[0]]})),n=e.length-1-e.slice().reverse().findIndex((function(e){return 0===t[e[1]][e[0]]}));if(-1!==o&&-1!==n){var i=e.slice(0,o),r=e.slice(n);return{start:{x:e[o][0],y:e[o][1]},end:{x:e[n][0],y:e[n][1]},pathToStart:i,pathToEnd:r}}},t.prototype.calculateDynamicPath=function(t,e,o,r,s){var a=this,c=new n.Grid(t),p=i.findPath(e.x,e.y,o.x,o.y,c),l=r.concat(p,s).map((function(t){return[a.diagramEngine.translateRoutingX(t[0],!0),a.diagramEngine.translateRoutingY(t[1],!0)]}));return n.Util.compressPath(l)},t}();e.default=r},359:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseWidget=void 0;var s=function(t){function e(e,o){var n=t.call(this,o)||this;return n.className=e,n}return i(e,t),e.prototype.bem=function(t){return(this.props.baseClass||this.className)+t+" "},e.prototype.getClassName=function(){return(this.props.baseClass||this.className)+" "+(this.props.className?this.props.className+" ":"")},e.prototype.getProps=function(){return r(r({},this.props.extraProps||{}),{className:this.getClassName()})},e}(o(297).Component);e.BaseWidget=s},983:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramWidget=void 0;var s=o(804),a=o(297),c=o(747),p=o(665),l=o(413),u=o(941),d=o(556),f=o(72),h=o(703),g=o(359),y=o(119),m=o(173),v=function(t){function e(e){var o=t.call(this,"srd-diagram",e)||this;return o.onKeyUpPointer=null,o.onMouseMove=o.onMouseMove.bind(o),o.onMouseUp=o.onMouseUp.bind(o),o.state={action:null,wasMoved:!1,renderedNodes:!1,windowListener:null,diagramEngineListener:null,document:null},o}return i(e,t),e.prototype.componentWillUnmount=function(){this.props.diagramEngine.removeListener(this.state.diagramEngineListener),this.props.diagramEngine.setCanvas(null),window.removeEventListener("keyup",this.onKeyUpPointer),window.removeEventListener("mouseUp",this.onMouseUp),window.removeEventListener("mouseMove",this.onMouseMove),document.getElementById("graphElement").removeEventListener("wheel",this.preventPageZoom)},e.prototype.componentWillReceiveProps=function(t){var e=this;if(this.props.diagramEngine!==t.diagramEngine){this.props.diagramEngine.removeListener(this.state.diagramEngineListener);var o=t.diagramEngine.addListener({repaintCanvas:function(){return e.forceUpdate()}});this.setState({diagramEngineListener:o})}},e.prototype.componentWillUpdate=function(t){this.props.diagramEngine.diagramModel.id!==t.diagramEngine.diagramModel.id&&(this.setState({renderedNodes:!1}),t.diagramEngine.diagramModel.rendered=!0),t.diagramEngine.diagramModel.rendered||(this.setState({renderedNodes:!1}),t.diagramEngine.diagramModel.rendered=!0)},e.prototype.componentDidUpdate=function(){this.state.renderedNodes||this.setState({renderedNodes:!0})},e.prototype.componentDidMount=function(){var t=this;this.onKeyUpPointer=this.onKeyUp.bind(this),this.setState({document,renderedNodes:!0,diagramEngineListener:this.props.diagramEngine.addListener({repaintCanvas:function(){t.forceUpdate()}})}),window.addEventListener("keyup",this.onKeyUpPointer,!1),window.focus(),document.getElementById("graphElement").addEventListener("wheel",this.preventPageZoom,{passive:!1})},e.prototype.getMouseElement=function(t){var e=t.target,o=this.props.diagramEngine.diagramModel,n=h.Toolkit.closest(e,".port[data-name]");if(n){var i=h.Toolkit.closest(e,".node[data-nodeid]");return{model:o.getNode(i.getAttribute("data-nodeid")).getPort(n.getAttribute("data-name")),element:n}}return(n=h.Toolkit.closest(e,".point[data-id]"))?{model:o.getLink(n.getAttribute("data-linkid")).getPointModel(n.getAttribute("data-id")),element:n}:(n=h.Toolkit.closest(e,"[data-linkid]"))?{model:o.getLink(n.getAttribute("data-linkid")),element:n}:(n=h.Toolkit.closest(e,".node[data-nodeid]"))?{model:o.getNode(n.getAttribute("data-nodeid")),element:n}:null},e.prototype.fireAction=function(){this.state.action&&this.props.actionStillFiring&&this.props.actionStillFiring(this.state.action)},e.prototype.stopFiringAction=function(t){this.props.actionStoppedFiring&&!t&&this.props.actionStoppedFiring(this.state.action),this.setState({action:null})},e.prototype.startFiringAction=function(t){var e=!0;this.props.actionStartedFiring&&(e=this.props.actionStartedFiring(t)),e&&this.setState({action:t})},e.prototype.onMouseMove=function(t){var e=this,o=this.props.diagramEngine,n=o.getDiagramModel();if(this.state.action instanceof l.SelectingAction){var i=o.getRelativePoint(t.clientX,t.clientY);return s.forEach(n.getNodes(),(function(t){e.state.action.containsElement(t.x,t.y,n)&&(t.selected||t.setSelected(!0))})),s.forEach(n.getLinks(),(function(t){var o=!0;s.forEach(t.points,(function(t){e.state.action.containsElement(t.x,t.y,n)?t.setSelected(!0):o=!1})),o&&t.setSelected(!0)})),this.state.action.mouseX2=i.x,this.state.action.mouseY2=i.y,this.fireAction(),void this.setState({action:this.state.action})}if(this.state.action instanceof p.MoveItemsAction&&!this.props.disableNodeMove){var r=t.clientX-this.state.action.mouseX,a=t.clientY-this.state.action.mouseY,f=n.getZoomLevel()/100;s.forEach(this.state.action.selectionModels,(function(t){t.model instanceof u.NodeModel||t.model instanceof d.PointModel&&!t.model.isConnectedToPort()?(t.model.x=n.getGridPosition(t.initialX+r/f),t.model.y=n.getGridPosition(t.initialY+a/f),t.model instanceof u.NodeModel&&s.forEach(t.model.getPorts(),(function(t){var o=e.props.diagramEngine.getPortCoords(t);t.updateCoords(o)})),o.isSmartRoutingEnabled()&&o.calculateRoutingMatrix()):t.model instanceof d.PointModel&&(t.model.x=t.initialX+n.getGridPosition(r/f),t.model.y=t.initialY+n.getGridPosition(a/f))})),o.isSmartRoutingEnabled()&&o.calculateCanvasMatrix(),this.fireAction(),this.props.onMovingSingle&&this.props.onMovingSingle(this.state.action),this.props.onMovingSingle2&&this.props.onMovingSingle2(this.state.action),this.state.wasMoved?this.forceUpdate():this.setState({wasMoved:!0})}else this.state.action instanceof c.MoveCanvasAction&&this.props.allowCanvasTranslation&&(n.setOffset(this.state.action.initialOffsetX+(t.clientX-this.state.action.mouseX),this.state.action.initialOffsetY+(t.clientY-this.state.action.mouseY)),n.setIsCanvasMoving(!0),this.fireAction(),this.forceUpdate())},e.prototype.onKeyUp=function(t){var e=this;t.path&&"INPUT"===t.path[0].tagName||this.props.blockDelete||-1!==this.props.deleteKeys.indexOf(t.keyCode)&&(s.forEach(this.props.diagramEngine.getDiagramModel().getSelectedItems(),(function(t){e.props.diagramEngine.isModelLocked(t)||t.remove()})),this.forceUpdate())},e.prototype.onMouseUp=function(t){var e,o,n=this,i=this.props.diagramEngine;if(this.state.action instanceof p.MoveItemsAction){var r=this.getMouseElement(t);s.forEach(this.state.action.selectionModels,(function(t){if(t.model instanceof d.PointModel){var o=t.model.getLink(),s=i.diagramModel.links;if(1===n.state.action.selectionModels.length&&r&&r.model&&r.model.toolType){var a="model"!==o.sourcePort.portType,c=void 0;if(o.sourcePort.in){for(var p=Object.keys(r.model.ports),l=0;l<p.length;l++){var u=p[l];if(!(g=r.model.ports[u]).in&&("model"===g.portType&&!a||"model"!==g.portType&&a)&&(c=u,0===Object.keys(g.links).length))break}if(c){var h=r.model.ports[c];n.props.shouldAddLink(o,h,o.sourcePort)&&((e=t.model.getLink().clone({})).setSourcePort(h),e.setTargetPort(o.sourcePort),i.getDiagramModel().addLink(e))}}else{for(p=Object.keys(r.model.ports),l=0;l<p.length;l++){var g;u=p[l];if((g=r.model.ports[u]).in&&("model"===g.portType&&!a||"model"!==g.portType&&a)&&(c=u,0===Object.keys(g.links).length))break}if(c){h=r.model.ports[c];n.props.shouldAddLink(o,o.sourcePort,h)&&((e=t.model.getLink().clone({})).setSourcePort(o.sourcePort),e.setTargetPort(h),i.getDiagramModel().addLink(e))}}}if(!r||r.model&&r.model.parent&&r.model.parent.id===o.sourcePort.parent.id){var y=n.state.action.selectionModels;(y&&1===y.length||null===o.getSourcePort()||null===o.getTargetPort()||o.getSourcePort().in===o.getTargetPort().in)&&o.remove()}else{if(!o.sourcePort)throw new Error("jsweetman-storm-react-diagrams point has not sourcePort or targetPort.");if(n.props.graphAlreadyHasLink(o,s,r),r&&r.model instanceof f.PortModel&&!i.isModelLocked(r.model)){var m=t.model.getLink();null!==m.getTargetPort()||m.setTargetPort(r.model),delete n.props.diagramEngine.linksThatHaveInitiallyRendered[m.getID()]}}}})),this.props.allowLooseLinks||s.forEach(this.state.action.selectionModels,(function(t){if(t.model instanceof d.PointModel){var e=t.model.getLink();null!==e.getSourcePort()&&null!==e.getTargetPort()||e.remove()}})),s.forEach(this.state.action.selectionModels,(function(t){if(t.model instanceof d.PointModel){var e=t.model.getLink(),n=e.getSourcePort(),r=e.getTargetPort();null!==n&&null!==r&&(n.in&&!r.in?((o=e.clone({})).setSourcePort(r),o.setTargetPort(n),i.getDiagramModel().addLink(o),e.remove()):n.in===r.in&&e.remove())}})),this.props.onMoveFinished&&this.state.wasMoved&&this.props.onMoveFinished(this.state.action,e,o),i.clearRepaintEntities(),this.stopFiringAction(!this.state.wasMoved)}else i.clearRepaintEntities(),i.getDiagramModel().setIsCanvasMoving(!1),this.stopFiringAction();this.state.document.removeEventListener("mousemove",this.onMouseMove),this.state.document.removeEventListener("mouseup",this.onMouseUp)},e.prototype.drawSelectionBox=function(){var t=this.state.action.getBoxDimensions();return a.createElement("div",{className:this.bem("__selector"),style:{top:t.top,left:t.left,width:t.width,height:t.height}})},e.prototype.preventPageZoom=function(t){t.ctrlKey&&t.preventDefault()},e.prototype.render=function(){var t=this,e=this.props.diagramEngine;e.setMaxNumberPointsPerLink(this.props.maxNumberPointsPerLink),e.setSmartRoutingStatus(this.props.smartRouting);var o=e.getDiagramModel();return a.createElement("div",r({},this.getProps(),{ref:function(e){e&&t.props.diagramEngine.setCanvas(e)},id:"graphElement",onWheel:function(e){if(t.props.allowCanvasZoom){e.stopPropagation();var n=o.getZoomLevel()/100,i=t.props.inverseZoom?-e.deltaY:e.deltaY;e.ctrlKey&&i%1!=0?i/=3:i/=60,o.getZoomLevel()+i>10&&o.setZoomLevel(o.getZoomLevel()+i);var r=o.getZoomLevel()/100,s=e.currentTarget.getBoundingClientRect(),a=s.width,c=s.height,p=a*r-a*n,l=c*r-c*n,u=e.clientX-s.left,d=e.clientY-s.top,f=(u-o.getOffsetX())/n/a,h=(d-o.getOffsetY())/n/c;o.setOffset(o.getOffsetX()-p*f,o.getOffsetY()-l*h),t.forceUpdate()}},onMouseDown:function(n){t.setState(r(r({},t.state),{wasMoved:!1})),e.clearRepaintEntities();var i=t.getMouseElement(n);if(null===i)if(n.shiftKey){var s=e.getRelativePoint(n.clientX,n.clientY);t.startFiringAction(new l.SelectingAction(s.x,s.y))}else o.clearSelection(),t.startFiringAction(new c.MoveCanvasAction(n.clientX,n.clientY,o));else if(i.model instanceof f.PortModel)if(t.props.diagramEngine.isModelLocked(i.model))o.clearSelection();else{s=e.getRelativeMousePoint(n);var a=i.model,u=a.createLinkModel();if(u.setSourcePort(a),u){u.removeMiddlePoints(),u.getSourcePort()!==a&&u.setSourcePort(a),u.setTargetPort(null),u.getFirstPoint().updateLocation(s),u.getLastPoint().updateLocation(s),o.clearSelection(),u.getLastPoint().setSelected(!0),o.addLink(u);var d=new p.MoveItemsAction(n.clientX,n.clientY,e);t.props.onMoveStart&&t.props.onMoveStart(d),t.startFiringAction(d)}}else n.shiftKey||i.model.isSelected()||o.clearSelection(),n.shiftKey&&i.model.isSelected()?i.model.setSelected(!1):i.model.setSelected(!0),t.startFiringAction(new p.MoveItemsAction(n.clientX,n.clientY,e));t.state.document.addEventListener("mousemove",t.onMouseMove),t.state.document.addEventListener("mouseup",t.onMouseUp)}}),this.state.renderedNodes&&a.createElement(y.LinkLayerWidget,{diagramEngine:e,pointAdded:function(n,i){t.state.document.addEventListener("mousemove",t.onMouseMove),t.state.document.addEventListener("mouseup",t.onMouseUp),i.stopPropagation(),o.clearSelection(n),t.setState({action:new p.MoveItemsAction(i.clientX,i.clientY,e)})}}),a.createElement(m.NodeLayerWidget,{diagramEngine:e}),this.state.action instanceof l.SelectingAction&&this.drawSelectionBox())},e.defaultProps={diagramEngine:null,allowLooseLinks:!0,allowCanvasTranslation:!0,allowCanvasZoom:!0,inverseZoom:!1,maxNumberPointsPerLink:1/0,smartRouting:!1,deleteKeys:[46,8]},e}(g.BaseWidget);e.DiagramWidget=v},279:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.LinkWidget=void 0;var r=function(t){function e(e){var o=t.call(this,"srd-link",e)||this;return o.state={},o}return i(e,t),e.prototype.shouldComponentUpdate=function(){return this.props.diagramEngine.canEntityRepaint(this.props.link)},e.prototype.render=function(){return this.props.children},e}(o(359).BaseWidget);e.LinkWidget=r},546:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.NodeWidget=void 0;var s=o(297),a=function(t){function e(e){var o=t.call(this,"srd-node",e)||this;return o.state={},o}return i(e,t),e.prototype.shouldComponentUpdate=function(t){return!!this.props.node.draw||this.props.diagramEngine.canEntityRepaint(this.props.node)},e.prototype.componentDidUpdate=function(){var t=this.props.node;t.draw&&t.stopDraw()},e.prototype.getClassName=function(){return"node "+t.prototype.getClassName.call(this)+(this.props.node.isSelected()?this.bem("--selected"):"")},e.prototype.render=function(){return s.createElement("div",r({},this.getProps(),{"data-nodeid":this.props.node.id,style:{top:this.props.node.y,left:this.props.node.x}}),this.props.children)},e}(o(359).BaseWidget);e.NodeWidget=a},94:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.PortWidget=void 0;var s=o(297),a=function(t){function e(e){var o=t.call(this,"srd-port",e)||this;return o.state={selected:!1},o}return i(e,t),e.prototype.getClassName=function(){return"port "+t.prototype.getClassName.call(this)+(this.state.selected?this.bem("--selected"):"")},e.prototype.render=function(){var t=this;return s.createElement("div",r({},this.getProps(),{onMouseEnter:function(){t.setState({selected:!0})},onMouseLeave:function(){t.setState({selected:!1})},"data-name":this.props.name,"data-nodeid":this.props.node.getID()}))},e}(o(359).BaseWidget);e.PortWidget=a},119:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.LinkLayerWidget=void 0;var s=o(297),a=o(861),c=function(t){function e(e){var o=t.call(this,"srd-link-layer",e)||this;return o.state={},o}return i(e,t),e.prototype.render=function(){var t=this.props.diagramEngine.getDiagramModel();return s.createElement("svg",r({},this.getProps(),{style:{transform:"translate("+t.getOffsetX()+"px,"+t.getOffsetY()+"px) scale("+t.getZoomLevel()/100+")"}}),s.createElement(a.LinkLayerWidgetInner,{diagramEngine:this.props.diagramEngine,pointAdded:this.props.pointAdded}))},e}(o(359).BaseWidget);e.LinkLayerWidget=c},861:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.LinkLayerWidgetInner=void 0;var r=o(297),s=o(279),a=o(804),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.shouldComponentUpdate=function(t){return!t.diagramEngine.getDiagramModel().getIsCanvasMoving()},e.prototype.render=function(){var t=this,e=this.props.diagramEngine.getDiagramModel();return r.createElement(r.Fragment,null,this.props.diagramEngine.canvas&&a.map(e.getLinks(),(function(e){if(t.props.diagramEngine.nodesRendered&&!t.props.diagramEngine.linksThatHaveInitiallyRendered[e.id]){if(null!==e.sourcePort)try{var o=t.props.diagramEngine.getPortCenter(e.sourcePort);e.points[0].updateLocation(o);var n=t.props.diagramEngine.getPortCoords(e.sourcePort);e.sourcePort.updateCoords(n),t.props.diagramEngine.linksThatHaveInitiallyRendered[e.id]=!0}catch(t){}if(null!==e.targetPort)try{o=t.props.diagramEngine.getPortCenter(e.targetPort);a.last(e.points).updateLocation(o);n=t.props.diagramEngine.getPortCoords(e.targetPort);e.targetPort.updateCoords(n),t.props.diagramEngine.linksThatHaveInitiallyRendered[e.id]=!0}catch(t){}}var i=t.props.diagramEngine.generateWidgetForLink(e);if(!i)throw new Error("no link generated for type: "+e.getType());return r.createElement(s.LinkWidget,{key:e.getID(),link:e,diagramEngine:t.props.diagramEngine},r.cloneElement(i,{pointAdded:t.props.pointAdded}))})))},e}(r.Component);e.LinkLayerWidgetInner=c},173:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.NodeLayerWidget=void 0;var s=o(297),a=o(804),c=o(359),p=o(770),l=function(t){function e(e){var o=t.call(this,"srd-node-layer",e)||this;return o.updateNodeDimensions=function(){if(!o.props.diagramEngine.nodesRendered){var t=o.props.diagramEngine.getDiagramModel();a.map(t.getNodes(),(function(t){t.updateDimensions(o.props.diagramEngine.getNodeDimensions(t))}))}},o.state={},o}return i(e,t),e.prototype.componentDidUpdate=function(){this.updateNodeDimensions(),this.props.diagramEngine.nodesRendered=!0},e.prototype.render=function(){var t=this.props.diagramEngine.getDiagramModel();return s.createElement("div",r({},this.getProps(),{style:{transform:"translate("+t.getOffsetX()+"px,"+t.getOffsetY()+"px) scale("+t.getZoomLevel()/100+")"}}),s.createElement(p.NodeLayerWidgetInner,{diagramEngine:this.props.diagramEngine}))},e}(c.BaseWidget);e.NodeLayerWidget=l},770:function(t,e,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.NodeLayerWidgetInner=void 0;var r=o(297),s=o(546),a=o(804),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.shouldComponentUpdate=function(t){return!t.diagramEngine.getDiagramModel().getIsCanvasMoving()},e.prototype.render=function(){var t=this,e=this.props.diagramEngine.getDiagramModel();return r.createElement(r.Fragment,null,a.map(e.getNodes(),(function(e){return r.createElement(s.NodeWidget,{diagramEngine:t.props.diagramEngine,key:e.id,node:e},t.props.diagramEngine.generateWidgetForNode(e))})))},e}(r.Component);e.NodeLayerWidgetInner=c},408:t=>{t.exports=require("closest")},804:t=>{t.exports=require("lodash")},500:t=>{t.exports=require("pathfinding")},723:t=>{t.exports=require("paths-js/path")},297:t=>{t.exports=require("react")}},e={};return function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,o),r.exports}(519)})()}));
//# sourceMappingURL=main.js.map